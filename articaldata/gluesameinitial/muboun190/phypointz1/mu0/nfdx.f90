subroutine nfdx(l,lb,nf0,nf1,nf2,nfd0x,nfd1x,nfd2x,nfd3x,nfd4x,nfd5x,nfd6x)
!Calculate the derivatives of fermi distribution functions
  implicit none

  real(8) l,lb,nf0,nf1,nf2
  real(8) nfd0x,nfd1x,nfd2x,nfd3x,nfd4x,nfd5x,nfd6x
  real(8) T,mu !temperature and chemical potential

  common /Tmu/ T,mu

  nfd0x=nf0 + lb*nf1 + l*nf2

  nfd1x=(-2*lb*nf1 - l*nf2 + 3*(nf0**2 + (lb*nf1 + l*nf2)**2 +                  &
       nf0*(-1 + 2*lb*nf1 + 2*l*nf2)))/T

  nfd2x=(18*nf0**3 + 27*nf0**2*(-1 + 2*lb*nf1 + 2*l*nf2) +                      &
    (-1 + 3*lb*nf1 + 3*l*nf2)*(6*lb**2*nf1**2 + 4*lb*nf1*(-1 + 3*l*nf2) +       &
       l*nf2*(-1 + 6*l*nf2)) +                                                  &
    9*nf0*(1 + 6*lb**2*nf1**2 + 2*l*nf2*(-2 + 3*l*nf2) +                        &
       lb*nf1*(-5 + 12*l*nf2)))/T**2

  nfd3x=(162*nf0**4 + 162*lb**4*nf1**4 + 324*nf0**3*(-1 + 2*lb*nf1 + 2*l*nf2) +   &
    216*lb**3*nf1**3*(-1 + 3*l*nf2) +                                           &
    8*lb*nf1*(-1 + 3*l*nf2)*(1 + 9*l*nf2*(-1 + 3*l*nf2)) +                      &
    l*nf2*(-1 + 3*l*nf2)*(1 + 18*l*nf2*(-1 + 3*l*nf2)) +                        &
    12*lb**2*nf1**2*(7 + 9*l*nf2*(-5 + 9*l*nf2)) +                              &
    27*nf0**2*(7 + 36*lb**2*nf1**2 + 4*l*nf2*(-7 + 9*l*nf2) +                   &
       8*lb*nf1*(-4 + 9*l*nf2)) +                                               &
    3*nf0*(-9 + 216*lb**3*nf1**3 + 36*lb**2*nf1**2*(-7 + 18*l*nf2) +            &
       8*lb*nf1*(11 + 27*l*nf2*(-2 + 3*l*nf2)) +                                &
       2*l*nf2*(29 + 18*l*nf2*(-5 + 6*l*nf2))))/T**3

  nfd4x=(1944*nf0**5 + 4860*nf0**4*(-1 + 2*lb*nf1 + 2*l*nf2) +                  &
    810*nf0**3*(5 + 24*lb**2*nf1**2 + 4*l*nf2*(-5 + 6*l*nf2) +                  &
       2*lb*nf1*(-11 + 24*l*nf2)) +                                             &
    45*nf0**2*(-27 + 432*lb**3*nf1**3 + 108*lb**2*nf1**2*(-5 + 12*l*nf2) +      &
       2*l*nf2*(83 + 216*l*nf2*(-1 + l*nf2)) +                                  &
       2*lb*nf1*(107 + 162*l*nf2*(-3 + 4*l*nf2))) +                             &
    (-1 + 3*lb*nf1 + 3*l*nf2)*(648*lb**4*nf1**4 +                               &
       864*lb**3*nf1**3*(-1 + 3*l*nf2) +                                        &
       l*nf2*(-1 + 6*l*nf2)*(1 + 36*l*nf2*(-1 + 3*l*nf2)) +                     &
       8*lb*nf1*(-1 + 3*l*nf2)*(2 + 27*l*nf2*(-1 + 4*l*nf2)) +                  &
       12*lb**2*nf1**2*(26 + 9*l*nf2*(-19 + 36*l*nf2))) +                       &
    3*nf0*(27 + 3240*lb**4*nf1**4 + 1620*lb**3*nf1**3*(-3 + 8*l*nf2) +          &
       60*lb**2*nf1**2*(41 + 108*l*nf2*(-2 + 3*l*nf2)) +                        &
       10*l*nf2*(-26 + 3*l*nf2*(43 + 108*l*nf2*(-1 + l*nf2))) +                 &
       5*lb*nf1*(-95 + 12*l*nf2*(61 + 27*l*nf2*(-7 + 8*l*nf2)))))/T**4

  nfd5x=(29160*nf0**6 + 29160*lb**6*nf1**6 +                                    &
    87480*nf0**5*(-1 + 2*lb*nf1 + 2*l*nf2) +                                    &
    58320*lb**5*nf1**5*(-1 + 3*l*nf2) +                                         &
    9*nf0*(-27 + 2*lb*nf1*(412 +                                                &
          45*lb*nf1*(-77 + 12*lb*nf1*(22 + 3*lb*nf1*(-11 + 6*lb*nf1)))) +       &
       374*l*nf2 + 900*l*lb*nf1*(-2 + 3*lb*nf1)*                                &
        (5 + 12*lb*nf1*(-2 + 3*lb*nf1))*nf2 +                                   &
       540*l**2*(-5 + 9*lb*nf1*(9 + 4*lb*nf1*(-9 + 10*lb*nf1)))*nf2**2 +        &
       2160*l**3*(5 + 6*lb*nf1*(-8 + 15*lb*nf1))*nf2**3 +                       &
       3240*l**4*(-7 + 30*lb*nf1)*nf2**4 + 19440*l**5*nf2**5) +                 &
    l*nf2*(-1 + 3*l*nf2)*(1 + 90*l*nf2*(1 - 6*l*nf2)**2*(-1 + 3*l*nf2)) +       &
    3240*lb**4*nf1**4*(13 + 27*l*nf2*(-3 + 5*l*nf2)) +                          &
    7290*nf0**4*(13 + 60*lb**2*nf1**2 + 4*l*nf2*(-13 + 15*l*nf2) +              &
       8*lb*nf1*(-7 + 15*l*nf2)) +                                              &
    12960*lb**3*nf1**3*(-1 + 3*l*nf2)*(1 + l*nf2*(-7 + 15*l*nf2)) +             &
    4*lb*nf1*(-1 + 3*l*nf2)*(8 +                                                &
       45*l*nf2*(-1 + 3*l*nf2)*(5 + 36*l*nf2*(-1 + 3*l*nf2))) +                 &
    1620*nf0**3*(-27 + 360*lb**3*nf1**3 +                                       &
       36*lb**2*nf1**2*(-13 + 30*l*nf2) +                                       &
       lb*nf1*(197 + 216*l*nf2*(-4 + 5*l*nf2)) +                                &
       4*l*nf2*(41 + 9*l*nf2*(-11 + 10*l*nf2))) +                               &
    27*nf0**2*(279 + 16200*lb**4*nf1**4 +                                       &
       12960*lb**3*nf1**3*(-2 + 5*l*nf2) +                                      &
       90*lb**2*nf1**2*(163 + 72*l*nf2*(-11 + 15*l*nf2)) +                      &
       20*lb*nf1*(-172 + 9*l*nf2*(133 + 360*l*nf2*(-1 + l*nf2))) +              &
       20*l*nf2*(-119 + 9*l*nf2*(53 + 18*l*nf2*(-6 + 5*l*nf2)))) +              &
    6*lb**2*nf1**2*(248 + 45*l*nf2*                                             &
        (-85 + 9*l*nf2*(59 + 12*l*nf2*(-14 + 15*l*nf2)))))/T**5

  nfd6x=(524880*nf0**7 + 16*lb*nf1*(-2 + 3*lb*nf1)*(-1 + 3*lb*nf1)*             &
     (2 + 45*lb*nf1*(-2 + 3*lb*nf1)*(2 + 9*lb*nf1*(-2 + 3*lb*nf1))) +           &
    l*(1 + 63*lb*nf1*(-49 + 6*lb*nf1*                                           &
           (343 + 15*lb*nf1*(-217 +                                             &
                12*lb*nf1*(65 + 9*lb*nf1*(-11 + 6*lb*nf1))))))*nf2 +            &
    189*l**2*(-1 + 2*lb*nf1*(143 +                                              &
          45*lb*nf1*(-69 + 4*lb*nf1*(103 + 9*lb*nf1*(-25 + 18*lb*nf1)))))*      &
     nf2**2 + 126*l**3*(43 + 180*lb*nf1*                                        &
        (-20 + 3*lb*nf1*(79 + 270*lb*nf1*(-1 + lb*nf1))))*nf2**3 +              &
    11340*l**4*(-5 + 6*lb*nf1*(29 + 90*lb*nf1*(-2 + 3*lb*nf1)))*nf2**4 +        &
    68040*l**5*(4 + 9*lb*nf1*(-7 + 18*lb*nf1))*nf2**5 +                         &
    612360*l**6*(-1 + 6*lb*nf1)*nf2**6 + 524880*l**7*nf2**7 +                   &
    1837080*nf0**6*(-1 + 2*lb*nf1 + 2*l*nf2) +                                  &
    3*nf0*(243 - 4732*l*nf2 + 7*                                                &
        (lb*nf1*(-1805 + 6*lb*nf1*                                              &
              (3889 + 135*lb*nf1*                                               &
                 (-153 + 4*lb*nf1*(97 + 9*lb*nf1*(-13 + 6*lb*nf1))))) +         &
          12*l*lb*nf1*(2209 +                                                   &
             540*lb*nf1*(-41 + lb*nf1*(161 + 54*lb*nf1*(-5 + 3*lb*nf1))))*      &
           nf2 + 6*l**2*(1129 +                                                 &
             540*lb*nf1*(-56 +                                                  &
                3*lb*nf1*(131 + 30*lb*nf1*(-11 + 9*lb*nf1))))*nf2**2 +          &
          12960*l**3*(-3 + lb*nf1*(52 + 45*lb*nf1*(-5 + 6*lb*nf1)))*            &
           nf2**3 + 16200*l**4*(8 + 81*lb*nf1*(-1 + 2*lb*nf1))*nf2**4 +         &
          116640*l**5*(-2 + 9*lb*nf1)*nf2**5 + 174960*l**6*nf2**6)) +           &
    34020*nf0**4*(-45 + 540*lb**3*nf1**3 +                                      &
       180*lb**2*nf1**2*(-4 + 9*l*nf2) +                                        &
       2*l*nf2*(136 + 45*l*nf2*(-7 + 6*l*nf2)) +                                &
       2*lb*nf1*(157 + 135*l*nf2*(-5 + 6*l*nf2))) +                             &
    612360*nf0**5*(18*lb**2*nf1**2 + lb*nf1*(-17 + 36*l*nf2) +                  &
       2*(2 + l*nf2*(-8 + 9*l*nf2))) +                                          &
    1134*nf0**3*(387 + 16200*lb**4*nf1**4 +                                     &
       5400*lb**3*nf1**3*(-5 + 12*l*nf2) +                                      &
       60*lb**2*nf1**2*(271 + 180*l*nf2*(-7 + 9*l*nf2)) +                       &
       40*l*nf2*(-80 + 3*l*nf2*(98 + 45*l*nf2*(-4 + 3*l*nf2))) +                &
       20*lb*nf1*(-209 + 6*l*nf2*(232 + 45*l*nf2*(-13 + 12*l*nf2)))) +          &
    189*nf0**2*(-243 + 58320*lb**5*nf1**5 +                                     &
       16200*lb**4*nf1**4*(-7 + 18*l*nf2) +                                     &
       1080*lb**3*nf1**3*(77 + 30*l*nf2*(-13 + 18*l*nf2)) +                     &
       4050*lb**2*nf1**2*(-7 + 4*l*nf2*(13 + 36*l*nf2*(-1 + l*nf2))) +          &
       2*lb*nf1*(2203 + 1620*l*nf2*                                             &
           (-13 + 2*l*nf2*(27 + 5*l*nf2*(-11 + 9*l*nf2)))) +                    &
       2*l*nf2*(1363 + 540*l*nf2*                                               &
           (-14 + l*nf2*(44 + 3*l*nf2*(-25 + 18*l*nf2))))))/T**6



end

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine nbdx(nb,nbd0x,nbd1x,nbd2x,nbd3x,nbd4x,nbd5x,nbd6x)
!Calculate the derivatives of fermi distribution functions
  implicit none

  real(8) nb
  real(8) nbd0x,nbd1x,nbd2x,nbd3x,nbd4x,nbd5x,nbd6x
  real(8) T,mu !temperature and chemical potential

  common /Tmu/ T,mu

  nbd0x=nb

  nbd1x=-((nb*(1 + nb))/T)

  nbd2x=(nb*(1 + nb)*(1 + 2*nb))/T**2

  nbd3x=-((nb*(1 + nb)*(1 + 6*nb*(1 + nb)))/T**3)

  nbd4x=(nb*(1 + nb)*(1 + 2*nb)*(1 + 12*nb*(1 + nb)))/T**4

  nbd5x=-((nb*(1 + nb)*(1 + 30*nb*(1 + nb)*(1 + 2*nb)**2))/T**5)

  nbd6x=(nb*(1 + nb)*(1 + 2*nb)*(1 + 60*nb*(1 + nb)*(1 + 6*nb*(1 + nb))))/T**6

end

